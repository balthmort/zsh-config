# vim:set ft=zsh:
# 
# Defines environment for the login shell.
# System variables such as path should be set here (not zshenv), as the system
# defines it commonly in /etc/(z)profile and zshenv would get overwritten
#

# Editors
export EDITOR=vim
export GIT_EDITOR=$EDITOR

# Language
[[ -z "$LANG" ]] && export LANG='cs_CZ.UTF-8'

# ===== Paths =====
typeset -gU path cdpath fpath mailpath pythonpath # Disable duplicates in paths

# Binary search paths
local -a cond_path # Conditional paths
# gcc coloring
[ -d /usr/lib/colorgcc/bin ] && cond_path=($cond_path /usr/lib/colorgcc/bin)
# Ruby version manager binaries
[[ -s $HOME/.rvm/scripts/rvm ]] && source $HOME/.rvm/scripts/rvm
[ -d $HOME/.rvm/bin ] && cond_path=($cond_path $HOME/.rvm/bin)

path=(
  ${HOME}/.local/bin
  ${cond_path}
  /usr/local/{bin,sbin}
  /usr/bin
  $path
)

# cd paths
cdpath=(
  .
  $HOME
  $cdpath
)

# Python path -- add /usr/local installations
pythonpath=(
  $pythonpath
  /usr/local/lib/python3.?/site-packages(N)
  /usr/local/lib/python2.?/site-packages(N)
)

# ===== XDG settings =====
export XDG_CONFIG_HOME="$HOME/.config"
eval "$(perl -Mlocal::lib=$HOME/.local/perl5)"

# ===== Other env variables =====
export NO_AT_BRIDGE=1

# GNOME Keyring
if [ -n "$DESKTOP_SESSION" ] && which gnome-keyring-daemon &>/dev/null; then
  eval $(gnome-keyring-daemon --start) && export SSH_AUTH_SOCK
fi

# ===== Export previously set variables ======
[ -x /usr/bin/systemctl ] && systemctl --user import-environment PATH NO_AT_BRIDGE DBUS_SESSION_BUS_ADDRESS
[ -x $HOME/.rvm/bin/rvm ] && rvm use default &>/dev/null
